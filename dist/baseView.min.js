!function(e,t,i){"use strict";e.wk=e.wk||{};var n=e.wk.getTemplate,o=0,s=i.app&&i.app.$document||e(document),a=i.app&&i.app.$window||e(i);e.wk.baseView=t.View.extend({constructor:function(){this.subviews={},this.noModelViewCounter=0,t.View.apply(this,arguments)},close:function(e){e||this.trigger("manualClosing"),this.hasSubviews()&&_.each(this.subviews,function(e){e.close("parentInitiated")}),this.ens&&(s.off(this.ens),a.off(this.ens)),this.onDocCancel.registry&&_.each(this.onDocCancel.registry,function(i,e){i&&(s.off(e),delete this.onDocCancel.registry[e])},this),this.beforeClose&&this.beforeClose(),this.remove()},closeSubviews:function(){this.hasSubviews()&&(_.each(this.subviews,function(e){e.close("parentInitiated")}),this.subviews={})},addSubview:function(e){var i=this;return e.model?this.subviews[e.model.cid]=e:this.subviews["noModelView"+ ++this.noModelViewCounter]=e,e.on("manualClosing",function(){delete i.subviews[e.model.cid]}),e},removeSubview:function(e){return this.subviews[e.cid]?(this.subviews[e.cid].close("parentInitiated"),void delete this.subviews[e.cid]):!1},getSubview:function(e){return this.subviews[e.cid]?this.subviews[e.cid]:!1},hasSubviews:function(){return _.size(this.subviews)>0?!0:!1},loadingOn:function(){this.$loadingHtml=this.$loadingHtml||e('<div class="loader"><span class="graphics">Loading</span></div>').appendTo(this.$el),this.$loading_html.addClass("on")},loadingOff:function(){this.$loadingHtml&&this.$loadingHtml.removeClass("on")},onDocCancel:function(o,n,a,c){this.onDocCancel.registry=this.onDocCancel.registry||{},this.setupEventNamespace();var i=this.ens+o,t=this.onDocCancel.registry,u=a||this.$el;return"off"===n?(s.off(i),void(t[i]=!1)):t[i]?void 0:(s.on("click"+i+" keyup"+i,function(o){if(o.keyCode&&27===o.keyCode)n();else{var a=e(o.target);a.parents().is(u)||n()}c&&(s.off(i),t[i]=!1)}),t[i]=!0,this)},setupEventNamespace:function(){return this.ens=this.ens||".view"+ ++o,this},getTemplate:function(s,t,e){var i=this;this.templates=this.templates||{};var o=n(t,function(t){i.templates[s]=t,e&&e.call(i,t)});return o}})}(window.jQuery,window.Backbone,window);